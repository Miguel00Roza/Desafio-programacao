<script>

    let alunos = ["João", "Maria", "Pedro", "Ana", "Carlos", "Beatriz"];
    let frequencia = [[], [], [], [], [], []];
    let totalDias = 20;
    let pctSitu = [[],[],[],[],[],[]];

    function adicionarPresenca() {
        let j = 0;
        // j equivale a qual posição lista de presença da matriz frequencia esta: 0-João 1-Maria 
        for (let aluno of alunos) {
            if (frequencia[j].length != 0) {
                j++;
                continue;
                // verifica se o aluno já tem as faltas cadastradas ( vai ser utilizado quando implementarmos um novo aluno )
            } else {
                for (let k = 1; k <= totalDias; k++) {
                    let hoje = prompt(`Situação do aluno ${aluno} no dia ${k} ( P-presente F-faltou )`).toUpperCase()
                    if (hoje == "P" || hoje == "F") {
                        console.log("digitou Certo");
                    } else {
                        alert("Digite apenas P ou F!");
                        alert("Perguntando novamente")
                        k--
                        // Caso o usuario digite algo diferente de P ou F ele perguntara sobre a situação do aluno no mesmo dia
                    }
                    frequencia[j].push(hoje);
                }
            }

            j++
        }
        // Pergunta a frequencia de todos os alunos pelos 20 dias 
    }

    function adicionarAluno() {
        while(true){
            let nomeNovoAluno = prompt("Digite o nome do novo aluno");

            if (typeof(nomeNovoAluno) != "string"){
            alert("Digite um nome não um numero!");
                continue
        } else if (nome.length < 3) {
                alert("Isso não é um nome, digite um nome de verdade");
        } else {
                break
        }
        }
        
        alunos.push(nomeNovoAluno);
        frequencia.push([]);
        pctSitu.push([]);
        alert("Aluno adicionado");

    }

    function removerAluno() {
        let alunosString = "";
        for(let i = 0; i < alunos.length; i++) {
            alunosString += `${i}-${alunos[i]}\n`;
        }
        while (true) {
            let index = Number(prompt("Digite o numero do aluno que você quer remover:\n" + alunosString));

            if(typeof(index) != "number") {
                alert("Digite o numero do aluno não o nome dele");
            } else if (index < 0 || index > alunos.length) {
                alert("Digite um numero equivalente ao numero de alunos (O numero de cada aluno está ao seu lado");
            } else {
                break
            }
        }
        

        alunos.splice(index, 1);
        frequencia.splice(index, 1);
        pctSitu.splice(index, 1);

        alert("Aluno removido com sucesso")
    }
    
    
function calcularPercentual(indexAluno) {
    let presencas = 0;

    for (let dia of frequencia[indexAluno]) {
        if (dia === "P") {
            presencas++;
        }
    }

    let perct = ((presencas / totalDias) * 100).toFixed(2);
    return [perct, presencas]
}

function gerarRelatiorio() {
        for (let i = 0; i < alunos.length; i++) {
            let [porcentagem, diasPresentes] = calcularPercentual(i);
            let diasAusentes = totalDias - diasPresentes;
            alert(`
            -------Aluno ${i + 1}: ${alunos[i]}-------\n
            Dias Presentes: ${diasPresentes},\n
            Dias Ausentes: ${diasAusentes},\n
            Frequencia: ${porcentagem}%,\n
            Sitação: ${(porcentagem < 60) ? "!EM RISCO!" : "De boas"};
            `);
        }
    }


while (true) {
    let opc = Number(prompt("O que você gostaria de fazer?\n 0-Sair\n 1-Registrar a frequencia dos alunos\n 2-Adicionar Aluno\n 3-Remover Aluno\n 4-Gerar relatorio"));

    if (opc == 0) {
        break
    } else if (opc == 1) {
        adicionarPresenca()
    } else if (opc == 2) {
        adicionarAluno()
    } else if (opc == 3) {
        removerAluno()
    } else if (opc == 4) {
        gerarRelatiorio()
        
    } else {
        alert("Opção invalida")
    }
}
</script>
